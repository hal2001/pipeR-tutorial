<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Pipe to first-argument | pipeR Tutorial</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../Pipe-function/Dot-function.html" />
    
    
    <link rel="prev" href="../Pipe-function/index.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
    

        
    <div class="book" data-level="3.1" data-basepath=".." data-revision="Mon Apr 06 2015 09:35:05 GMT+0800 (China Standard Time)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="Getting-started/index.html">
            
                
                    <a href="../Getting-started/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Getting started
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="Getting-started/First-example.html">
            
                
                    <a href="../Getting-started/First-example.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        First example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Getting-started/Design-principles.html">
            
                
                    <a href="../Getting-started/Design-principles.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Design principles
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="Pipe-operator/index.html">
            
                
                    <a href="../Pipe-operator/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Pipe operator
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="Pipe-operator/Pipe-to-first-argument.html">
            
                
                    <a href="../Pipe-operator/Pipe-to-first-argument.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Pipe to first-argument
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Pipe-operator/Pipe-to-dot.html">
            
                
                    <a href="../Pipe-operator/Pipe-to-dot.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Pipe to dot
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Pipe-operator/Pipe-by-formula.html">
            
                
                    <a href="../Pipe-operator/Pipe-by-formula.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Pipe by formula
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Pipe-operator/Pipe-for-side-effect.html">
            
                
                    <a href="../Pipe-operator/Pipe-for-side-effect.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Pipe for side effect
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="Pipe-operator/Pipe-with-assignment.html">
            
                
                    <a href="../Pipe-operator/Pipe-with-assignment.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Pipe with assignment
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="Pipe-operator/Extract-element.html">
            
                
                    <a href="../Pipe-operator/Extract-element.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Extract element
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Pipe-function/index.html">
            
                
                    <a href="../Pipe-function/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Pipe function
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.1" data-path="Pipe-function/Pipe-to-first-argument.html">
            
                
                    <a href="../Pipe-function/Pipe-to-first-argument.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Pipe to first-argument
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="Pipe-function/Dot-function.html">
            
                
                    <a href="../Pipe-function/Dot-function.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Dot function
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="Pipe-function/Subsetting.html">
            
                
                    <a href="../Pipe-function/Subsetting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Subsetting
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="Pipeline/index.html">
            
                
                    <a href="../Pipeline/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Pipeline
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="Pipeline/Argument.html">
            
                
                    <a href="../Pipeline/Argument.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Argument-based pipeline
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="Pipeline/Expression.html">
            
                
                    <a href="../Pipeline/Expression.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Expression-based pipeline
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="Examples/index.html">
            
                
                    <a href="../Examples/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Examples
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="Examples/dplyr.html">
            
                
                    <a href="../Examples/dplyr.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        dplyr
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="Examples/rlist.html">
            
                
                    <a href="../Examples/rlist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        rlist
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="Examples/rvest.html">
            
                
                    <a href="../Examples/rvest.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        rvest
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >pipeR Tutorial</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="pipe-to-first-argument">Pipe to first argument</h1>
<p><code>Pipe()</code> creates a Pipe object that supports light-weight chaining with <code>$</code>. Basically, it is like a box containing a value and for this box <code>$</code> is defined to perform first-argument piping.</p>
<p>The example in the page that introduces the first-argument piping feature of <code>%&gt;&gt;%</code> can be translated using <code>Pipe()</code> and <code>$</code>:</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(pipeR)
set.seed(<span class="hljs-number">123</span>)
Pipe(rnorm(<span class="hljs-number">100</span>, mean = <span class="hljs-number">10</span>))$
  log()$
  diff()$
  sample(size = <span class="hljs-number">10000</span>, replace = <span class="hljs-literal">TRUE</span>)$
  summary()
</code></pre>
<pre><code># &lt;Pipe: summaryDefault table&gt;
#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
# -0.309500 -0.083720 -0.012360 -0.001854  0.071440  0.358400
</code></pre><p>You may notice that in the beginning of the pipeline, the numeric vector generated by <code>rnorm()</code> is converted to a <code>Pipe</code> object by <code>Pipe()</code>. Since <code>$</code> for <code>Pipe</code> object is defined for first-argument piping, the name following <code>$</code> will be interpreted to a function name, and then <code>()</code> will execute that function with the value in <code>Pipe</code> put to the first argument, and put the result into the next <code>Pipe</code> object. In this way, the pipeline continues chaining.</p>
<p>In other words, <code>Pipe(x)$f()</code> works like <code>Pipe(f(x))</code>, and <code>Pipe(x)$f(a)$g(b)</code> works like <code>Pipe(g(f(x,a),b))</code>, which can be further grown and become more nested if written without <code>$</code> chaining. </p>
<p>Also note that the output does not look exactly the same with that produced by <code>%&gt;&gt;%</code> but with a header added on top of the summary table. Recall the version of code using the operator:</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">123</span>)
rnorm(<span class="hljs-number">100</span>, mean = <span class="hljs-number">10</span>) %&gt;&gt;%
  log %&gt;&gt;%
  diff %&gt;&gt;%
  sample(size = <span class="hljs-number">10000</span>, replace = <span class="hljs-literal">TRUE</span>) %&gt;&gt;%
  summary
</code></pre>
<pre><code>#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
# -0.309500 -0.083720 -0.012360 -0.001854  0.071440  0.358400
</code></pre><p>In fact, the result produced by <code>Pipe()</code> is not really the summary table but a box (<code>Pipe</code> object) that contains it, and therefore the object can continue piping with <code>$</code>. <code>Pipe</code> object implements several generic functions to make it easier to inspect and manipulate the value in the box. To extract the inner value, call <code>$value</code>, or simply <code>[]</code> as shortcut.</p>
<pre><code class="lang-r">set.seed(<span class="hljs-number">123</span>)
Pipe(rnorm(<span class="hljs-number">100</span>, mean = <span class="hljs-number">10</span>))$
  log()$
  diff()$
  sample(size = <span class="hljs-number">10000</span>, replace = <span class="hljs-literal">TRUE</span>)$
  summary()$
  value
</code></pre>
<pre><code>#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
# -0.309500 -0.083720 -0.012360 -0.001854  0.071440  0.358400
</code></pre><p>With <code>$value</code> in the end of the pipeline, <code>value</code> is extracted from the Pipe object, and this object is no longer a <code>Pipe</code> so that <code>$</code> won&apos;t pipe any more.</p>
<p>Here is another example that runs a linear regression with <code>mtcars</code>.</p>
<pre><code class="lang-r">Pipe(mtcars)$
  lm(formula = mpg ~ wt + cyl)
</code></pre>
<pre><code># &lt;Pipe: lm&gt;
# 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Coefficients:
# (Intercept)           wt          cyl  
#      39.686       -3.191       -1.508
</code></pre><p>Use <code>[]</code> to extract the <code>lm</code> object inside the resulted <code>Pipe</code> object.</p>
<pre><code class="lang-r">Pipe(mtcars)$
  lm(formula = mpg ~ wt + cyl) []
</code></pre>
<pre><code># 
# Call:
# lm(formula = mpg ~ wt + cyl, data = .)
# 
# Coefficients:
# (Intercept)           wt          cyl  
#      39.686       -3.191       -1.508
</code></pre><p>The Pipe header no longer exists, which indicates that the value is extracted.</p>
<p>Just like <code>%&gt;&gt;%</code>, in the function call after <code>$</code> also supports <code>.</code> to represent the input value. For example,</p>
<pre><code class="lang-r">Pipe(mtcars$mpg)$
  plot(col = <span class="hljs-string">&quot;red&quot;</span>, main = sprintf(<span class="hljs-string">&quot;mpg (%d obs.)&quot;</span>, length(.)))
</code></pre>
<p><img src="figure/pipe-dot-1.png" title="plot of chunk pipe-dot" alt="plot of chunk pipe-dot" style="display: block; margin: auto;"></p>
<p>You may notice that the previous <code>plot()</code> only produces graphics but the <code>NULL</code> value it returns are not explicitly printed. <code>Pipe</code> by design mutes <code>NULL</code> value as being printed. However, not all graphics functions return <code>NULL</code>. <code>hist()</code> is one example.</p>
<pre><code class="lang-r">Pipe(mtcars$mpg)$
  hist(main = <span class="hljs-string">&quot;distribution of mpg&quot;</span>)
</code></pre>
<p><img src="figure/pipe-hist-1.png" title="plot of chunk pipe-hist" alt="plot of chunk pipe-hist" style="display: block; margin: auto;"></p>
<p>The output is no longer <code>NULL</code> but a new <code>Pipe</code> object consisting of a <code>histogram</code> object with a few elements indicating its properties. </p>
<p>All <code>Pipe</code> objects are printed with, by default, a header like <code>$value: class</code>. If you find it annoying, you can turn off the header by setting the option <code>Pipe.header</code> to <code>FALSE</code> with</p>
<pre><code class="lang-r">options(Pipe.header = <span class="hljs-literal">FALSE</span>)
</code></pre>
<p>This is <strong>NOT</strong> recommended because <code>Pipe</code> object and ordinary objects are essentially different. For better distinction, we suggest that you give  all <code>Pipe</code> objects name that start with <code>p</code> and do not turn off this option.</p>
<p>The following example demonstrate a recommended use of <code>Pipe</code> object in multiple ways.</p>
<pre><code class="lang-r">pmtcars &lt;- Pipe(mtcars)$
  subset(mpg &gt;= quantile(mpg, <span class="hljs-number">0.05</span>) &amp; mpg &lt;= quantile(mpg, <span class="hljs-number">0.95</span>))

pmtcars$
  lm(formula = mpg ~ wt + cyl)$
  coef()
</code></pre>
<pre><code># &lt;Pipe: numeric&gt;
# (Intercept)          wt         cyl 
#   36.630834   -2.528175   -1.418216
</code></pre><pre><code class="lang-r">pmtcars$
  lm(formula = mpg ~ wt + cyl + qsec)$
  summary()$
  coef()
</code></pre>
<pre><code># &lt;Pipe: matrix&gt;
#               Estimate Std. Error    t value     Pr(&gt;|t|)
# (Intercept) 33.4441378  6.8351140  4.8929890 5.453045e-05
# wt          -2.8134666  0.9787605 -2.8745201 8.344557e-03
# cyl         -1.2183510  0.5495775 -2.2168865 3.635652e-02
# qsec         0.1605394  0.3343038  0.4802202 6.354189e-01
</code></pre><p>Note that we create a <code>Pipe</code> object from <code>mtcars</code> and filters it by lower and upper quantile. The result is still a <code>Pipe</code> object so that we can pipe with it further until we use <code>$value</code> or <code>[]</code> to extract its value.</p>
<h2 id="creating-partial-function">Creating partial function</h2>
<p>Since <code>$</code> gets a function for <code>Pipe</code> object for first-argument piping, the function can be saved for repetitive uses.</p>
<p>For example, we resample <code>mtcars$mpg</code> and draws its density function estimated by Gaussian kernel method. Instead of directly plotting the graphics, we save <code>plot</code> in pipeline for further use.</p>
<pre><code class="lang-r">density_plot &lt;- Pipe(mtcars$mpg)$
  sample(size = <span class="hljs-number">10000</span>, replace = <span class="hljs-literal">TRUE</span>)$
  density(kernel = <span class="hljs-string">&quot;gaussian&quot;</span>)$
  plot
</code></pre>
<p>The function is a partial function of built-in <code>plot()</code> because its contents are determined and only additional parameters of graphics are needed.</p>
<pre><code class="lang-r">par(mfrow=c(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))
density_plot(col = <span class="hljs-string">&quot;blue&quot;</span>, main = <span class="hljs-string">&quot;blue points&quot;</span>)
density_plot(col = <span class="hljs-string">&quot;gray&quot;</span>, type = <span class="hljs-string">&quot;o&quot;</span>, main = <span class="hljs-string">&quot;gray circles&quot;</span>)
</code></pre>
<p><img src="figure/partial-function-1.png" title="plot of chunk partial-function" alt="plot of chunk partial-function" style="display: block; margin: auto;"></p>
<p>Note that when the partial function is determined, all the steps before the function are already evaluated, which means that the random numbers will not change each time we call the partial function <code>density_plot()</code>.</p>
<p>It is useful when we need to do something only with different parameters but with the same input to the first argument.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../Pipe-function/index.html" class="navigation navigation-prev " aria-label="Previous page: Pipe function"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Pipe-function/Dot-function.html" class="navigation navigation-next " aria-label="Next page: Dot function"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-47159422-1","configuration":"auto"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-47159422-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
